{
  "contract": "private_bank",
  "tool": "slither",
  "analysis": {
    "success": true,
    "total_findings": 19,
    "findings_by_severity": {
      "High": 2,
      "Medium": 0,
      "Low": 0,
      "Informational": 15,
      "Optimization": 2
    },
    "findings_by_check": {
      "controlled-array-length": 1,
      "reentrancy-eth": 1,
      "solc-version": 2,
      "low-level-calls": 1,
      "naming-convention": 12,
      "constable-states": 1,
      "external-function": 1
    },
    "findings": [
      {
        "check": "controlled-array-length",
        "impact": "High",
        "confidence": "Medium",
        "description": "Log (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#55-80) contract sets array length with a user-controlled value:\n\t- History.push(LastMsg) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#77)",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L55-L80",
        "lines": [
          55,
          56,
          57,
          58,
          59,
          60,
          61,
          62,
          63,
          64,
          65,
          66,
          67,
          68,
          69,
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78,
          79,
          80
        ]
      },
      {
        "check": "reentrancy-eth",
        "impact": "High",
        "confidence": "Medium",
        "description": "Reentrancy in Private_Bank.CashOut(uint256) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#38-49):\n\tExternal calls:\n\t- msg.sender.call.value(_am)() (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#43)\n\tState variables written after the call(s):\n\t- balances[msg.sender] -= _am (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#45)\n\tPrivate_Bank.balances (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#16) can be used in cross function reentrancies:\n\t- Private_Bank.CashOut(uint256) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#38-49)\n\t- Private_Bank.Deposit() (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#27-36)\n\t- Private_Bank.balances (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#16)",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L38-L49",
        "lines": [
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49
        ]
      },
      {
        "check": "solc-version",
        "impact": "Informational",
        "confidence": "High",
        "description": "Version constraint ^0.4.19 contains known severe issues (https://solidity.readthedocs.io/en/latest/bugs.html)\n\t- DirtyBytesArrayToStorage\n\t- ABIDecodeTwoDimensionalArrayMemory\n\t- KeccakCaching\n\t- EmptyByteArrayCopy\n\t- DynamicArrayCleanup\n\t- ImplicitConstructorCallvalueCheck\n\t- TupleAssignmentMultiStackSlotComponents\n\t- MemoryArrayCreationOverflow\n\t- privateCanBeOverridden\n\t- SignedArrayStorageCopy\n\t- ABIEncoderV2StorageArrayWithMultiSlotElement\n\t- DynamicConstructorArgumentsClippedABIV2\n\t- UninitializedFunctionPointerInConstructor_0.4.x\n\t- IncorrectEventSignatureInLibraries_0.4.x\n\t- ABIEncoderV2PackedStorage_0.4.x\n\t- ExpExponentCleanup\n\t- EventStructWrongData\n\t- NestedArrayFunctionCallDecoder.\nIt is used by:\n\t- ^0.4.19 (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#12)",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L12",
        "lines": [
          12
        ]
      },
      {
        "check": "solc-version",
        "impact": "Informational",
        "confidence": "High",
        "description": "solc-0.4.19 is an outdated solc version. Use a more recent version (at least 0.8.0), if possible.",
        "first_markdown_element": ""
      },
      {
        "check": "low-level-calls",
        "impact": "Informational",
        "confidence": "High",
        "description": "Low level call in Private_Bank.CashOut(uint256) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#38-49):\n\t- msg.sender.call.value(_am)() (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#43)",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L38-L49",
        "lines": [
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Variable Log.History (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#66) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L66",
        "lines": [
          66
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Variable Log.LastMsg (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#68) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L68",
        "lines": [
          68
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Parameter Log.AddMessage(address,uint256,string)._adr (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#70) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L70",
        "lines": [
          70
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Function Log.AddMessage(address,uint256,string) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#70-78) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L70-L78",
        "lines": [
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Contract Private_Bank (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#14-53) is not in CapWords",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L14-L53",
        "lines": [
          14,
          15,
          16,
          17,
          18,
          19,
          20,
          21,
          22,
          23,
          24,
          25,
          26,
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36,
          37,
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49,
          50,
          51,
          52,
          53
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Variable Private_Bank.MinDeposit (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#18) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L18",
        "lines": [
          18
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Parameter Log.AddMessage(address,uint256,string)._data (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#70) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L70",
        "lines": [
          70
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Function Private_Bank.Deposit() (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#27-36) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L27-L36",
        "lines": [
          27,
          28,
          29,
          30,
          31,
          32,
          33,
          34,
          35,
          36
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Variable Private_Bank.TransferLog (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#20) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L20",
        "lines": [
          20
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Function Private_Bank.CashOut(uint256) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#38-49) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L38-L49",
        "lines": [
          38,
          39,
          40,
          41,
          42,
          43,
          44,
          45,
          46,
          47,
          48,
          49
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Parameter Log.AddMessage(address,uint256,string)._val (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#70) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L70",
        "lines": [
          70
        ]
      },
      {
        "check": "naming-convention",
        "impact": "Informational",
        "confidence": "High",
        "description": "Parameter Private_Bank.CashOut(uint256)._am (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#38) is not in mixedCase",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L38",
        "lines": [
          38
        ]
      },
      {
        "check": "constable-states",
        "impact": "Optimization",
        "confidence": "High",
        "description": "Private_Bank.MinDeposit (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#18) should be constant",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L18",
        "lines": [
          18
        ]
      },
      {
        "check": "external-function",
        "impact": "Optimization",
        "confidence": "High",
        "description": "AddMessage(address,uint256,string) should be declared external:\n\t- Log.AddMessage(address,uint256,string) (scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#70-78)",
        "first_markdown_element": "scripts/dataset/solidity/exploits/exploits/ethereum/honeypot/private_bank.sol#L70-L78",
        "lines": [
          70,
          71,
          72,
          73,
          74,
          75,
          76,
          77,
          78
        ]
      }
    ],
    "metadata": {
      "total_contracts": 0,
      "error": null
    }
  }
}